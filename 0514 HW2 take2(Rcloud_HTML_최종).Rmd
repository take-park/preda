---
title: "HW2"
author: "take"
date: '2021 5 14 '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Exponential family

< 1ë²ˆì‹ >
$$f_Y (y;Î¸,Ï•) =exp\left[\frac{y\theta-b(\theta)}{a(\phi)}+c(y,\phi)\right] $$

### 1) Express the p.d.f of random variable ğ‘Œ

$$ ğ‘Œ âˆ¼ ğµğ‘’ğ‘Ÿğ‘›ğ‘¢ğ‘™ğ‘™ğ‘– (ğ‘)$$ì´ë©´, 

$$f_Y (y;p)=p^y (1-p)^{(1-y)} $$
ì´ë¯€ë¡œ, ì´ ì‹ì„ exp í˜•íƒœë¡œ ë³€í˜•í•˜ì—¬ ì •ë¦¬í•˜ë©´,
$$=exp[ylnp + (1-y)ln(1-p) ]  $$


$$ =exp[ylnp +ln(1-p) - yln(1-p)]  $$
$$ =exp[y[lnp- ln(1-p)] +ln(1-p) ]  $$
$$ =exp\left[yln\frac{p}{1-p}+ln(1-p)\right] $$
$$ =exp\left[\frac{yln\frac{p}{1-p}+ln(1-p)}{1}+0\right] $$
ì´ ëœë‹¤. ì´ë¥¼ ë§¨ ìœ„ < 1ë²ˆì‹ >ê³¼ ë¹„êµí•˜ë©´, 

$\theta= ln\frac{p}{1-p}$ ì´ê³ , $b(\theta)= - ln(1-p)$, $a(\phi) = 1$, $c(y,\phi) = 0$ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

Î¸ì™€ pì˜ ì‹ì„ ì´ìš©í•˜ì—¬, b(Î¸) ë¶€ë¶„ì„ ì¢€ë” ì •ë¦¬í•˜ë©´,

$$\theta= ln\frac{p}{1-p}$$
$$e^{\theta}= \frac{p}{1-p}$$
$$e^{\theta}(1-p) = p$$

$$e^{\theta} =(e^{\theta}+1) p$$

$$p=\frac{e^{\theta}}{e^{\theta}+1}$$
ì´ë¥¼ b(Î¸)ì— ëŒ€ì…í•˜ë©´,
$$b(\theta)= -ln(1-p) = -ln(1-\frac{e^{\theta}}{e^{\theta}+1})= -ln(\frac{e^{\theta}+1-e^{\theta}}{e^{\theta}+1})= -ln(\frac{1}{e^{\theta}+1})= ln(e^{\theta}+1) $$
ë”°ë¼ì„œ, \

$\theta= ln\frac{p}{1-p}$ ì´ê³ , $b(\theta)=ln(e^{\theta}+1)$, $a(\phi) = 1$, $c(y,\phi) = 0$ì´ë‹¤.\

\

### 2) Express the p.d.f of random variable ğ‘Œ

$$ ğ‘Œ âˆ¼ ğ‘ƒ ğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘› (ğœ†)$$ì´ë©´, 

$$f_Y (y;Î»)=\frac{\lambda^{y}e^{(-\lambda)}}{y!} $$
ì´ë¯€ë¡œ, ì´ ì‹ì„ exp í˜•íƒœë¡œ ë³€í˜•í•˜ì—¬ ì •ë¦¬í•˜ë©´,
$$=exp[ylnÎ» + (-y) - ln(y!) ]  $$

$$=exp\left[\frac{ylnÎ» -y}{1}+(- ln(y!))\right] $$


ì´ ëœë‹¤. ì´ë¥¼ ë§¨ ìœ„ < 1ë²ˆì‹ >ê³¼ ë¹„êµí•˜ë©´, 

$\theta= lnÎ»$ ì´ê³ , $b(\theta)= y$, $a(\phi) = 1$, $c(y,\phi) = - ln(y!)$ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

Î¸ì™€ pì˜ ì‹ì„ ì´ìš©í•˜ì—¬, b(Î¸) ë¶€ë¶„ì„ ì¢€ë” ì •ë¦¬í•˜ë©´,

$\theta= ln\frac{p}{1-p}$ ì´ê³ , $b(\theta)=e^{\theta}$, $a(\phi) = 1$, $c(y,\phi) = 0$ì´ë‹¤.\


### 3) Verify the logit link for the logistic regression and the log link for the poisson regression are the canonical link functions.

b'(Î¸)=Î¼ì´ë¯€ë¡œ, \

Î¸ = g(Î¼) = g(b'(Î¸))ì´ê³ , ì–‘ë³€ì— gì˜ ì—­í•¨ìˆ˜ë¥¼ ì·¨í•˜ë©´,\

g^-I^(Î¸) = b'(Î¸)ì´ ë˜ê³ , \
g(Î¸) = [b'(Î¸)]^-I^ ì´ ëœë‹¤. \

\

<1-3)-1. ë² ë¥´ëˆ„ì´>

ìœ„ 1)ì—ì„œ êµ¬í•œ b(Î¸)ë¥¼ ì´ìš©í•˜ì—¬ ì •ë¦¬í•˜ë©´, \

\

$$ g(\theta)={b'(\theta)}^{-I}={\left(\frac{e^{\theta}}{e^{\theta}+1}\right)}^{-I}=ln(\frac{\theta}{1-\theta})$$
ì´ë¯€ë¡œ,

$$ g(\mu)=ln(\frac{\mu}{1-\mu})=\theta$$
ê°€ ëœë‹¤.


<1-3)-2. í”„ì•„ì†¡>


ìœ„ 2)ì—ì„œ êµ¬í•œ b(Î¸)ë¥¼ ì´ìš©í•˜ì—¬ ì •ë¦¬í•˜ë©´, \

\

$$ g(\theta)={b'(\theta)}^{-I}={(e^{\theta})}^ {-I}=ln\theta$$
ì´ë¯€ë¡œ,

$$ g(\mu)=ln\mu=\theta$$
ê°€ ëœë‹¤.\

\
\



## 2. Maximum Likelihood Estimator of Poisson Regression

### 1) Calculate the coefficients by using the following code.

```{r}
example_data <- read.csv("./0514 hw2_table1.csv")
head(example_data)
```

```{r}
model <- glm(Claims ~ Gender + Territory, family = poisson(link = log), data = example_data)
model$coefficients
```

\


### 2) Find the coefficients of Poisson regression above using an user define R function via gradient descent algorithm. 

ì£„ì†¡í•©ë‹ˆë‹¤.

